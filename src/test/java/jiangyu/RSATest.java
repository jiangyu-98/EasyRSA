package jiangyu;

import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class RSATest {
    @Test
    void generateKey() {
        RSA.Key key = RSA.generateKey(256);
        System.out.println(key);
    }

    @Test
    void testKey() {
        assertTrue((new java.math.BigInteger(p.toString(), 16)).isProbablePrime(20));
        assertTrue((new java.math.BigInteger(q.toString(), 16)).isProbablePrime(20));
        assertFalse((new java.math.BigInteger(n.toString(), 16)).isProbablePrime(20));
        BigInteger kkk = new BigInteger("3f213");
        BigInteger eee = kkk.powMod(e, n);
        BigInteger ddd = eee.powMod(d, n);
        assertEquals(kkk, ddd);
    }

    @Test
    void encrypt() {
        RSA.Key key = new RSA.Key(p, q, n, d, e);
        RSA rsa = new RSA(key);
        String text = rsa.encrypt(plainText);
        assertEquals(cipherText, text);
    }

    @Test
    void decrypt() {
        RSA.Key key = new RSA.Key(p, q, n, d, e);
        RSA rsa = new RSA(key);
        String text = rsa.decrypt(cipherText);
        assertEquals(plainText, text);
    }

    @Test
    void stringToByte() {
        String a = "1243423FFFF1";
        System.out.println(RSA.byteToString(RSA.stringToByte(a)));
    }

    BigInteger p = new BigInteger("69F2894908D22914B1AC763B0403A0E2C1CE1B910EF780F6F7FEB9122755F719");
    BigInteger q = new BigInteger("6AD80DAFB026B2FB3307980B10893616F7FE26A79CFA657F1978288FC983B311");
    BigInteger n = new BigInteger("2C37D72619F1C72A1F0F18B965BAA200EA7FECE4F2AC416A11D726CA3B5CD05005CD3376F579BB37CDDEDEE9464B36169DF9AC8BC7CEA59334D78AACCB46E3A9");
    BigInteger e = new BigInteger("3A77C76B15D94593");
    BigInteger d = new BigInteger("267A21D91C4C6030E5A072F5EFD6C263C2AF79F85B4A9584D017094A5B7BA2CCBADCD622165F9986E24A642F152329B35BAE2757B23192C63B3DA0A8F934569B");

    String plainText = """
            新华社北京11月15日电 11月16日出版的第22期《求是》杂志将发表中共中央总书记、国家主席、中央军委主席习近平的重要文章《推进全面依法治国，发挥法治在国家治理体系和治理能力现代化中的积极作用》。
                            
            　　文章强调，坚持全面依法治国，是中国特色社会主义国家制度和国家治理体系的显著优势。我国社会主义法治凝聚着我们党治国理政的理论成果和实践经验，是制度之治最基本最稳定最可靠的保障。要推进全面依法治国，发挥法治在国家治理体系和治理能力现代化中的积极作用。
                            
            　　文章指出，要坚持全面依法治国，夯实中国之治的制度根基。要提高党依法治国、依法执政能力，用法治保障人民当家作主，坚持和完善中国特色社会主义法治体系，更好发挥法治对改革发展稳定的引领、规范、保障作用，建设高素质法治工作队伍。
                            
            　　文章指出，要坚持顶层设计和法治实践相结合，提升法治促进国家治理体系和治理能力现代化的效能。要加快建立健全国家治理急需、满足人民日益增长的美好生活需要必备的法律制度。要加强对法律实施的监督，努力提升执法司法的质量、效率、公信力，更好把社会主义法治优势转化为国家治理效能。
                            
            　　文章强调，各级领导干部必须强化法治意识，带头尊法学法守法用法，做制度执行的表率。要加大全民普法工作力度，弘扬社会主义法治精神，增强全民法治观念，完善公共法律服务体系，夯实依法治国社会基础。要坚持依法治国和以德治国相结合，把社会主义核心价值观融入法治建设，努力形成良好的社会风尚和社会秩序。""";

    String cipherText = "06ABB55716FE84E778CBE97B328F622E18737A09FC3E7223EA85561C955F098B6309FFD5A48B70E0FB9D0A643080FE4D6DE2D91235756F0883B4F02F7A0137BA23F68E2448CFA47BC486DD38D13EDEA9C8DF790FF4CBE25DA017ECB86909CF48B54A30073772101C3ED532FED10B901EA3C0AA6A5D09D632E6B319B3C47AF58F14CCBF4A6A350A8E17810FDD9681BE53657820B9344BD4C02FABB5026C598EC8ACBCA2D01888106FB58795809362864E575CDF749FF75E63AD805AF1D5DB7FBB2384DE0C948BCFE2E149D085D237B0B447E5815D521BA0280AEE4E94290788D8BB1679E5A489EB7FC2425C56BA594C785E118900F6DF4E11D6424B5EE8485AAF25AED3DAA6F90DFCBB1E6A5765AB8AD3A937F0F15DD6BA5483FE512C94EC41193F13B079526986C5455D7EB3F6129377469675EB50599A6749E9CA8819B7E6C206CB6CECD10E1BC6D4A53F909DA0EC920C117A5FD60D0E91B7280D53329E57C6B3920C1068086731689384F8A64DE34759BC72A5F2E026896926F79139DF9BE61D5AB63157A3E2D68E12CFF52F4DD7754FEB71DADC5B6C8F2C75EEDC8B0B61F25CB1194BCDA012F28335D0B1E0779BC68BCDAA473E4A07715517C9A3E844DE1E2534B9E7B998F835CEB27554266277AC9AC0200FADC96D9ABF4FBD854076AB15D6BE7461EFF8F0B6FAFD53B9CC8F5769F1AD14E6714CCC0319DFB25D9FBBE98B0C067C471290975660DD8A13551EB3491A9D60A6280A6965B2C7A0BBA17468F0B207E1DB556DE555A970DC2C6CDB99BBA82B5114D2545198FA9F9F5A95714AA41898716CC1CD20A8C357820C2819C866C1D1538512248FE01F4CEE241E9C1731BA726E9384386E11014D44A647FCAF17A51D60408285041FAA9D29A0364E355B154AB7065573D9EA5274B8AD5AC0AF1C4891AB2F73F62469E26B88AB0223C6B9900CF3F216F6B29FB9FE2F13073921A35A605EFBECB4808457133DC8ABCFF44822597C3B50E0D90264ACC23227C83CA36BE2639481BE9304BA8EDB47B2B504A09DD0D6E536B94FDCE108A862F47B4C457CF3CF8C4FAB07D9A88724B2E1ACA1371BA5C16724B6D2A42DC34AF232D1B45983CFCC3E7F072ADF6E94FD728CA12A8A86C4A7F14386B0283490B75D393E8CEAC4E8B5CB161D8537585E073EDC761E0A25DD1928DC7FF826779DF2D75062C7769F932556E2633A8C712EAA76D03ED21543E0C9CCF2956E28069A820A36267FDCAD77D4CEAEC96B1858D9F7A96AC347220E8D294170541260D958B3731BEE8640C306DC72B32BBB4E83B4A6EC6B958581C0300CD43EE8D0067D9AC8A524591F6BB8E3070D6B3A2642F503DB5374DEA1EA0D49A1A7CA71EE76BC775D8B2131B3E9BF0BF18E779BF2E32A6B8D426332BF6DCCA55477B778533295EB8A67B8E4F7073C2C8DCB4BE2414135181638D406DAD824074F3CAD84AFA42570765DD3C7722F1BF990089D3C17283E630A72E266E6CF0EC113078FD05E1E68CF34A21FD4F7C033694B690826461DFED96605E05F3DDA1B42E0370A0E8C9F4773B16A5C2A54C45FC5EB2154F437DDAF97B147A0912A5E53628EF44D047C0C646B364747E109C147B3C522DDA5785CF473A509CF2EE8B623CB240460CBF0796F30D9D9DBD668CFFEB8C9381D6707AD85A9C437C06CA69DBDB17B902303F5E786A4616D85157F8532ADFBF3320A2A502B4BBA1A4BA6E95C0DA106905C460578370D40571DC747C9306BD444FC8F41823115E6FA1E9CA29ACB9CEE3DDC689F6D01FB4A832DB32F17FC7F5836570C0F906CBF491DF24FFF9B03C0E3D85D76CBA254684157C4DD9CD572F99BBF9B6D67657CD867AFF579F3F61098EF69B72451BC79536CB6688DE2F8DACB819FB89CFACB1D2780DF10F098961E5265CE6CC868C2AAD2E9EA357B164836CCD2FA5E9978953A9DB0F11CB040D0D8B2FF3C79B86068E85DCDAE8E703C3871BBE4599FD47D2E8E3059BAB7276E540E255FB411757413064BF5C4BB408E527E4DF88D99C02E025BF62FEFE1A450140A6CB078A27F9E65F18A1E3F5DBE351713AB01BB09B1F9F95B5F2B8C22A9B5001A677CF2A157265B9CA0CCEAD727F6F030E34115BEC41F4508D5EA594858F5B017CCC06E8C2B33F5A4671307249094C6F38202300480F60B6B6F631F54CA02860C8CD3E767D4CA9262F833CAACD061721E9B6CDFDB3FA53B7179F73EF5F380219A266E263A4A453D386905B2719C5779084BFB641EE750E3F7F661B5DE6CCB7A201C55C861EEEA7375F6D612D1EA8FECED621C84B5B0B2FB8DF340167B472A6B1AC7C546014FB69134A0785EE8FECF56BF2F3663263B24935874C3A8C19863611A8B6DE88073BF4106AAF0E5BB4030F14AD2650848726BABECEF447EBA1E4C26E060C20643F9585E36E3DA0C678BB9AF3C7B06CD65FAAACC79E769F0435F8C3D0D837CB064F108FDD9F00CE8A55261FE3EB9D2E8DFFB5FF775BC22E746BE4952211B7FAE2F1163EFE8E29CCACB196AE96A1BC0DCFA4D61E52FF9E3D820F74EF50073B042971682F4211DCE918D603CCC358A21740EBA34C329AD092B14AC5BC951D406F43EB8145BCDE646177372A403C2FA0091111EEAD839A4A8FEC405DFCD0EE8D30FF73D5B381FEBE77DF938B620BE72976EF4E33AC8FCB596913DAED7C65F45CE3C4E4B01120AC1B01689CC27471107528B148CAD284AD05F85F7F88675";
}